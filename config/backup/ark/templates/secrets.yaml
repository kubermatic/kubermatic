#{{- if and .Values.ark.credentials.useSecret (not .Values.ark.credentials.existingSecret) -}}
#apiVersion: v1
#kind: Secret
#metadata:
#  name: {{ template "ark.fullname" . }}
#type: Opaque
#data:
#{{- range $key, $value := .Values.ark.credentials.secretContents }}
#  {{ $key }}: {{ $value | b64enc | quote }}
#{{- end }}
#{{- end -}}

---
# This secret contains the password with which restic is encrypting all
# the backups. It must be called "ark-restic-credentials" and contain
# the key "repository-password".
apiVersion: v1
kind: Secret
metadata:
  name: ark-restic-credentials
type: Opaque
data:
  repository-password: {{ "mysecret" | b64enc | quote }}

---
# This secret contains the autentication that restic needs to access its
# backend, i.e. the Minio / AWS S3 credentials. This is a file that gets
# read by the ark restic server and whose name must match the
# AWS_SHARED_CREDENTIALS_FILE environment variable.
apiVersion: v1
kind: Secret
metadata:
  name: cloud-credentials
type: Opaque
data:
  cloud: {{ .Values.ark.credentials.aws | b64enc | quote }}
