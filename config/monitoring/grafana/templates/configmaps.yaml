apiVersion: v1
kind: List
items:
- apiVersion: v1
  kind: ConfigMap
  metadata:
    name: grafana-datasources
  data:
    datasources.yaml: |
{{ (.Files.Get "config/datasources.yaml") | indent 6 }}

- apiVersion: v1
  kind: ConfigMap
  metadata:
    name: grafana-dashboards
  data:
    dashboards.yaml: |
{{ (.Files.Get "config/dashboards.yaml") | indent 6 }}

- apiVersion: v1
  kind: ConfigMap
  metadata:
    name: grafana-dashboard-definitions
  data:
    {{- range $file, $content := (.Files.Glob "dashboards/**") }}
    {{ $file | replace "dashboards/" "" | replace "/" "-" }}: |
{{ printf "%s" $content | indent 6 }}
    {{- end }}
